(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[436],{5180:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/console",function(){return s(5466)}])},5466:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return h}});var n=s(5893),r=s(9008),a=s.n(r),i=s(4123),o=s(8901),l=s(7294),c=s(7066);let d="http://localhost:5000";function x(e){let{sessionId:t,isVisible:s,onClose:r}=e,{user:a}=(0,o.aF)(),[i,x]=(0,l.useState)({items:[],pagination:{page:1,per_page:20,total:0,pages:0,has_next:!1,has_prev:!1}}),[m,g]=(0,l.useState)([]),[u,h]=(0,l.useState)(null),[p,b]=(0,l.useState)(null),[v,y]=(0,l.useState)(new Set),[j,f]=(0,l.useState)(""),[N,w]=(0,l.useState)(""),[S,E]=(0,l.useState)(!1),[k,_]=(0,l.useState)("pending"),[C,I]=(0,l.useState)(1),[T,A]=(0,l.useState)(null),[R,D]=(0,l.useState)(""),O=(0,l.useRef)(null),P=(0,l.useCallback)(()=>{O.current&&clearInterval(O.current),O.current=setInterval(()=>{s&&a&&(M(),U(),F())},5e3)},[s,a,t,C,T,R]),L=(0,l.useCallback)(()=>{O.current&&(clearInterval(O.current),O.current=null)},[]);(0,l.useEffect)(()=>(s&&a?(M(),U(),F(),P()):L(),()=>L()),[s,a,t,C,T,R,P,L]),(0,l.useEffect)(()=>{let e=e=>{s&&p&&("a"===e.key&&e.altKey?(e.preventDefault(),z("approve")):"r"===e.key&&e.altKey?(e.preventDefault(),z("reject")):"e"===e.key&&e.altKey?(e.preventDefault(),z("edit")):"Escape"===e.key&&(b(null),y(new Set)))};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[s,p]);let M=async()=>{try{E(!0);let e=new URLSearchParams({user_id:(null==a?void 0:a.id)||"",page:C.toString(),per_page:"20"});T&&e.append("priority",T.toString()),R&&e.append("response_type",R);let s=await c.Z.get("".concat(d,"/api/session/").concat(t,"/pending-responses?").concat(e));x(s.data)}catch(e){console.error("Error fetching pending responses:",e)}finally{E(!1)}},U=async()=>{try{let e=await c.Z.get("".concat(d,"/api/session/").concat(t,"/dm/notifications?user_id=").concat(null==a?void 0:a.id));g(e.data)}catch(e){console.error("Error fetching notifications:",e)}},F=async()=>{try{let e=await c.Z.get("".concat(d,"/api/session/").concat(t,"/dm/analytics?user_id=").concat(null==a?void 0:a.id));h(e.data)}catch(e){console.error("Error fetching analytics:",e)}},z=async e=>{if(p&&a)try{E(!0),await c.Z.post("".concat(d,"/api/session/").concat(t,"/pending-response/").concat(p.id,"/review"),{user_id:a.id,action:e,final_response:"edit"===e?j:void 0,dm_notes:N}),await M(),await U(),await F(),b(null),f(""),w("")}catch(e){console.error("Error reviewing response:",e)}finally{E(!1)}},B=async e=>{if(0!==v.size&&a)try{E(!0),await c.Z.post("".concat(d,"/api/session/").concat(t,"/pending-responses/bulk"),{user_id:a.id,action:e,response_ids:Array.from(v),dm_notes:N}),await M(),await U(),await F(),y(new Set),w("")}catch(e){console.error("Error bulk reviewing responses:",e)}finally{E(!1)}},W=async e=>{try{await c.Z.post("".concat(d,"/api/session/").concat(t,"/dm/notifications/").concat(e,"/mark-read"),{user_id:null==a?void 0:a.id}),await U(),await F()}catch(e){console.error("Error marking notification as read:",e)}},G=e=>{let t=new Set(v);t.has(e)?t.delete(e):t.add(e),y(t)},H=e=>{switch(e){case 3:return"text-red-400 bg-red-900";case 2:return"text-yellow-400 bg-yellow-900";default:return"text-green-400 bg-green-900"}},Y=e=>{switch(e){case 3:return"HIGH";case 2:return"MEDIUM";default:return"LOW"}},Z=e=>new Date(e).toLocaleString();return s?(0,n.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50",children:(0,n.jsxs)("div",{className:"bg-gray-900 text-green-400 p-6 rounded-lg max-w-6xl w-full max-h-[90vh] overflow-y-auto",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,n.jsx)("h2",{className:"text-2xl font-bold text-red-400",children:"DM REVIEW DASHBOARD"}),(0,n.jsx)("button",{onClick:r,className:"text-red-400 hover:text-red-300 text-xl font-bold",children:"\xd7"})]}),(0,n.jsxs)("div",{className:"flex mb-6 border-b border-gray-700",children:[(0,n.jsxs)("button",{className:"px-4 py-2 font-mono ".concat("pending"===k?"text-green-400 border-b-2 border-green-400":"text-gray-400 hover:text-green-400"),onClick:()=>_("pending"),children:["PENDING RESPONSES (",i.items.length,")"]}),(0,n.jsxs)("button",{className:"px-4 py-2 font-mono ".concat("notifications"===k?"text-green-400 border-b-2 border-green-400":"text-gray-400 hover:text-green-400"),onClick:()=>_("notifications"),children:["NOTIFICATIONS (",m.length,")"]}),(0,n.jsx)("button",{className:"px-4 py-2 font-mono ".concat("analytics"===k?"text-green-400 border-b-2 border-green-400":"text-gray-400 hover:text-green-400"),onClick:()=>_("analytics"),children:"ANALYTICS"})]}),"pending"===k&&(0,n.jsxs)("div",{className:"space-y-6",children:[(0,n.jsxs)("div",{className:"bg-gray-800 p-4 rounded border border-gray-600",children:[(0,n.jsxs)("div",{className:"flex flex-wrap gap-4 items-center justify-between",children:[(0,n.jsxs)("div",{className:"flex gap-4 items-center",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-xs text-gray-400 mb-1",children:"PRIORITY FILTER"}),(0,n.jsxs)("select",{value:T||"",onChange:e=>{A(e.target.value?parseInt(e.target.value):null),I(1)},className:"bg-gray-700 text-green-400 p-2 rounded border border-gray-600 text-sm",children:[(0,n.jsx)("option",{value:"",children:"ALL"}),(0,n.jsx)("option",{value:"3",children:"HIGH"}),(0,n.jsx)("option",{value:"2",children:"MEDIUM"}),(0,n.jsx)("option",{value:"1",children:"LOW"})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-xs text-gray-400 mb-1",children:"TYPE FILTER"}),(0,n.jsxs)("select",{value:R,onChange:e=>{D(e.target.value),I(1)},className:"bg-gray-700 text-green-400 p-2 rounded border border-gray-600 text-sm",children:[(0,n.jsx)("option",{value:"",children:"ALL TYPES"}),(0,n.jsx)("option",{value:"narrative",children:"NARRATIVE"}),(0,n.jsx)("option",{value:"dice_roll",children:"DICE ROLL"}),(0,n.jsx)("option",{value:"npc_action",children:"NPC ACTION"})]})]})]}),v.size>0&&(0,n.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,n.jsxs)("span",{className:"text-sm text-gray-400",children:[v.size," selected"]}),(0,n.jsx)("button",{onClick:()=>B("approve"),className:"px-3 py-1 bg-green-600 hover:bg-green-700 text-white text-sm rounded",children:"Bulk Approve"}),(0,n.jsx)("button",{onClick:()=>B("reject"),className:"px-3 py-1 bg-red-600 hover:bg-red-700 text-white text-sm rounded",children:"Bulk Reject"})]})]}),(0,n.jsx)("div",{className:"mt-2 text-xs text-gray-500",children:"Shortcuts: Alt+A (approve), Alt+R (reject), Alt+E (edit), Esc (clear selection)"})]}),(0,n.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,n.jsx)("h3",{className:"text-lg font-mono text-yellow-400",children:"PENDING REVIEWS"}),i.items.length>0&&(0,n.jsx)("button",{onClick:()=>{v.size===i.items.length?y(new Set):y(new Set(i.items.map(e=>e.id)))},className:"text-xs text-blue-400 hover:text-blue-300",children:v.size===i.items.length?"Deselect All":"Select All"})]}),S?(0,n.jsx)("div",{className:"text-center py-8",children:(0,n.jsx)("div",{className:"text-green-400",children:"Loading..."})}):0===i.items.length?(0,n.jsx)("div",{className:"text-center py-8 text-gray-400",children:"No pending responses to review"}):(0,n.jsx)("div",{className:"space-y-4",children:i.items.map(e=>(0,n.jsx)("div",{className:"p-4 border rounded transition-colors ".concat((null==p?void 0:p.id)===e.id?"border-green-400 bg-green-900 bg-opacity-20":"border-gray-600 hover:border-gray-500"),children:(0,n.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,n.jsx)("input",{type:"checkbox",checked:v.has(e.id),onChange:t=>{t.stopPropagation(),G(e.id)},className:"mt-1 text-green-400 bg-gray-700 border-gray-600 rounded focus:ring-green-500"}),(0,n.jsxs)("div",{className:"flex-1 cursor-pointer",onClick:()=>{b(e),f(e.ai_response),w("")},children:[(0,n.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsx)("span",{className:"px-2 py-1 text-xs rounded ".concat(H(e.priority)),children:Y(e.priority)}),(0,n.jsx)("span",{className:"text-blue-400 text-sm font-mono",children:e.response_type.toUpperCase()})]}),(0,n.jsx)("span",{className:"text-xs text-gray-400",children:Z(e.created_at)})]}),(0,n.jsxs)("div",{className:"text-sm text-gray-300 mb-2",children:[(0,n.jsx)("strong",{children:"Player:"})," ",e.user_id]}),(0,n.jsxs)("div",{className:"text-sm text-gray-300",children:[(0,n.jsx)("strong",{children:"Context:"})," ",e.context.substring(0,100),"..."]})]})]})},e.id))}),i.pagination.pages>1&&(0,n.jsxs)("div",{className:"mt-4 flex justify-between items-center text-sm",children:[(0,n.jsxs)("div",{className:"text-gray-400",children:["Page ",i.pagination.page," of ",i.pagination.pages,"(",i.pagination.total," total)"]}),(0,n.jsxs)("div",{className:"flex space-x-2",children:[(0,n.jsx)("button",{onClick:()=>I(C-1),disabled:!i.pagination.has_prev,className:"px-3 py-1 bg-gray-700 hover:bg-gray-600 disabled:opacity-50 disabled:cursor-not-allowed text-green-400 rounded",children:"Previous"}),(0,n.jsx)("button",{onClick:()=>I(C+1),disabled:!i.pagination.has_next,className:"px-3 py-1 bg-gray-700 hover:bg-gray-600 disabled:opacity-50 disabled:cursor-not-allowed text-green-400 rounded",children:"Next"})]})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h3",{className:"text-lg font-mono mb-4 text-yellow-400",children:"REVIEW PANEL"}),p?(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)("div",{className:"p-4 border border-gray-600 rounded",children:[(0,n.jsx)("h4",{className:"text-green-400 font-mono mb-2",children:"AI RESPONSE"}),(0,n.jsx)("div",{className:"text-gray-300 text-sm max-h-40 overflow-y-auto",children:p.ai_response})]}),(0,n.jsxs)("div",{className:"p-4 border border-gray-600 rounded",children:[(0,n.jsx)("h4",{className:"text-green-400 font-mono mb-2",children:"EDIT RESPONSE"}),(0,n.jsx)("textarea",{value:j,onChange:e=>f(e.target.value),className:"w-full h-32 bg-gray-700 text-green-400 p-2 rounded border border-gray-600 text-sm",placeholder:"Edit the AI response..."})]}),(0,n.jsxs)("div",{className:"p-4 border border-gray-600 rounded",children:[(0,n.jsx)("h4",{className:"text-green-400 font-mono mb-2",children:"DM NOTES"}),(0,n.jsx)("textarea",{value:N,onChange:e=>w(e.target.value),className:"w-full h-20 bg-gray-700 text-green-400 p-2 rounded border border-gray-600 text-sm",placeholder:"Add notes about this review..."})]}),(0,n.jsxs)("div",{className:"flex space-x-2",children:[(0,n.jsx)("button",{onClick:()=>z("approve"),className:"flex-1 px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded font-mono",disabled:S,children:"APPROVE (Alt+A)"}),(0,n.jsx)("button",{onClick:()=>z("edit"),className:"flex-1 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded font-mono",disabled:S,children:"EDIT (Alt+E)"}),(0,n.jsx)("button",{onClick:()=>z("reject"),className:"flex-1 px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded font-mono",disabled:S,children:"REJECT (Alt+R)"})]})]}):(0,n.jsx)("div",{className:"text-center py-8 text-gray-400",children:"Select a response to review"})]})]})]}),"notifications"===k&&(0,n.jsxs)("div",{children:[(0,n.jsx)("h3",{className:"text-lg font-mono mb-4 text-yellow-400",children:"NOTIFICATIONS"}),0===m.length?(0,n.jsx)("div",{className:"text-center py-8 text-gray-400",children:"No notifications"}):(0,n.jsx)("div",{className:"space-y-4",children:m.map(e=>(0,n.jsxs)("div",{className:"p-4 border border-gray-600 rounded cursor-pointer hover:border-gray-500",onClick:()=>W(e.id),children:[(0,n.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,n.jsx)("span",{className:"text-blue-400 text-sm font-mono",children:e.notification_type.toUpperCase()}),(0,n.jsx)("span",{className:"text-xs text-gray-400",children:Z(e.created_at)})]}),(0,n.jsx)("div",{className:"text-gray-300 text-sm",children:e.message})]},e.id))})]}),"analytics"===k&&(0,n.jsxs)("div",{children:[(0,n.jsx)("h3",{className:"text-lg font-mono mb-4 text-yellow-400",children:"ANALYTICS"}),u?(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)("div",{className:"p-4 border border-gray-600 rounded",children:[(0,n.jsx)("h4",{className:"text-green-400 font-mono mb-2",children:"QUEUE STATUS"}),(0,n.jsxs)("div",{className:"text-gray-300 text-sm",children:[(0,n.jsx)("strong",{children:"Pending:"})," ",u.queue_status.pending_count]}),(0,n.jsxs)("div",{className:"text-gray-300 text-sm",children:[(0,n.jsx)("strong",{children:"High Priority:"})," ",u.queue_status.high_priority_count]})]}),(0,n.jsxs)("div",{className:"p-4 border border-gray-600 rounded",children:[(0,n.jsx)("h4",{className:"text-green-400 font-mono mb-2",children:"REVIEW STATISTICS"}),(0,n.jsxs)("div",{className:"text-gray-300 text-sm",children:[(0,n.jsx)("strong",{children:"Total Reviewed:"})," ",u.review_stats.total_reviewed]}),(0,n.jsxs)("div",{className:"text-gray-300 text-sm",children:[(0,n.jsx)("strong",{children:"Approved:"})," ",u.review_stats.approved_count]}),(0,n.jsxs)("div",{className:"text-gray-300 text-sm",children:[(0,n.jsx)("strong",{children:"Rejected:"})," ",u.review_stats.rejected_count]}),(0,n.jsxs)("div",{className:"text-gray-300 text-sm",children:[(0,n.jsx)("strong",{children:"Edited:"})," ",u.review_stats.edited_count]}),(0,n.jsxs)("div",{className:"text-gray-300 text-sm",children:[(0,n.jsx)("strong",{children:"Approval Rate:"})," ",u.review_stats.approval_rate.toFixed(2),"%"]}),(0,n.jsxs)("div",{className:"text-gray-300 text-sm",children:[(0,n.jsx)("strong",{children:"Average Review Time:"})," ",u.review_stats.avg_review_time_minutes.toFixed(2)," minutes"]})]}),(0,n.jsxs)("div",{className:"p-4 border border-gray-600 rounded",children:[(0,n.jsx)("h4",{className:"text-green-400 font-mono mb-2",children:"NOTIFICATIONS"}),(0,n.jsxs)("div",{className:"text-gray-300 text-sm",children:[(0,n.jsx)("strong",{children:"Unread:"})," ",u.notifications.unread_count]})]})]}):(0,n.jsx)("div",{className:"text-center py-8 text-gray-400",children:"Loading analytics..."})]})]})}):null}let m={shadowrunBarren:{name:"Shadowrun Barren",background:"bg-gray-950",text:"text-red-300",secondaryText:"text-gray-400",accent:"bg-red-900 text-red-100",prompt:"text-green-500",input:"bg-gray-900 border-red-900 border",inputText:"text-red-200",secondaryBackground:"bg-gray-900"},matrix:{name:"Matrix",background:"bg-black",text:"text-green-400",secondaryText:"text-green-600",accent:"bg-green-700 text-green-200",prompt:"text-green-500",input:"bg-black border-green-700 border",inputText:"text-green-400",secondaryBackground:"bg-green-900 bg-opacity-20"},cyberpunk:{name:"Cyberpunk",background:"bg-purple-900",text:"text-pink-300",secondaryText:"text-blue-300",accent:"bg-pink-600 text-blue-200",prompt:"text-yellow-300",input:"bg-purple-800 border-pink-500 border",inputText:"text-pink-300",secondaryBackground:"bg-purple-800"},terminal:{name:"Terminal",background:"bg-black",text:"text-amber-400",secondaryText:"text-amber-600",accent:"bg-amber-800 text-amber-200",prompt:"text-amber-500",input:"bg-black border-amber-700 border",inputText:"text-amber-400",secondaryBackground:"bg-amber-900 bg-opacity-20"}},g=[{id:"xs",name:"Extra Small",class:"text-xs"},{id:"sm",name:"Small",class:"text-sm"},{id:"base",name:"Medium",class:"text-base"},{id:"lg",name:"Large",class:"text-lg"},{id:"xl",name:"Extra Large",class:"text-xl"}];function u(){var e;let{user:t,isSignedIn:s}=(0,o.aF)(),[r,a]=(0,l.useState)(""),[i,d]=(0,l.useState)([]),[u,h]=(0,l.useState)("> "),[p,b]=(0,l.useState)(!1),[v,y]=(0,l.useState)(!1),[j,f]=(0,l.useState)(!1),[N,w]=(0,l.useState)(null),[S,E]=(0,l.useState)(!1),k=(0,l.useRef)(null),_=(0,l.useRef)(null),[C,I]=(0,l.useState)({theme:"shadowrunBarren",fontSize:"base"});(0,l.useEffect)(()=>{let e=localStorage.getItem("shadowrun-settings");if(e)try{let t=JSON.parse(e);I(t)}catch(e){console.error("Failed to parse settings:",e)}h(s?"".concat((null==t?void 0:t.firstName)||"User","@SR > "):"> "),d([{command:"",output:'Shadowrun Interface Terminal v1.0\nType "help" for available commands.\nConnecting to the Matrix...'}])},[s,t]),(0,l.useEffect)(()=>{localStorage.setItem("shadowrun-settings",JSON.stringify(C))},[C]),(0,l.useEffect)(()=>{_.current&&(_.current.scrollTop=_.current.scrollHeight)},[i]),(0,l.useEffect)(()=>{k.current&&k.current.focus()},[]);let T=function(e,t){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];d(r=>[...r,{command:e,output:t,isProcessing:s,isStreaming:n}])},A=async e=>{let s=e.split(" "),n=s[1],r=s.slice(2).join(" ");if("create"===n){if(!r){T(e,"Error: Session name is required. Usage: /session create [name]",!1);return}try{let s=await c.Z.post("http://localhost:5000/api/session",{name:r,gm_user_id:null==t?void 0:t.id});w(s.data.session_id),E(!0),T(e,'Session "'.concat(r,'" created successfully!\nSession ID: ').concat(s.data.session_id,"\nYou are the Game Master."),!1)}catch(t){T(e,"Error creating session: ".concat(t instanceof Error?t.message:"Unknown error"),!1)}}else if("join"===n){if(!r){T(e,"Error: Session ID is required. Usage: /session join [id]",!1);return}try{await c.Z.post("http://localhost:5000/api/session/".concat(r,"/join"),{user_id:null==t?void 0:t.id,role:"player"}),w(r),E(!1),T(e,"Joined session ".concat(r," as a player."),!1)}catch(t){T(e,"Error joining session: ".concat(t instanceof Error?t.message:"Unknown error"),!1)}}else T(e,"Error: Invalid session command. Use /session create [name] or /session join [id]",!1)},R=async e=>{let s=e.substring(4).trim();if(!s){T(e,"Error: Please provide a message for the AI. Usage: /ai [your message]",!1);return}if(!N){T(e,"Error: You must be in a session to use AI features.",!1);return}try{let i=await c.Z.post("http://localhost:5000/api/session/".concat(N,"/llm-with-review"),{user_id:null==t?void 0:t.id,context:s,response_type:"narrative",priority:1,require_review:!S});if("pending_review"===i.data.status)T(e,"AI response generated and sent for DM review.\n"+"Request ID: ".concat(i.data.pending_response_id,"\n")+"You will be notified when the DM approves your response.",!1);else{var n,r,a;T(e,(null===(a=i.data.choices)||void 0===a?void 0:null===(r=a[0])||void 0===r?void 0:null===(n=r.message)||void 0===n?void 0:n.content)||"AI response received.",!1)}}catch(t){T(e,"Error getting AI response: ".concat(t instanceof Error?t.message:"Unknown error"),!1)}},D=async e=>{if(e.preventDefault(),!r.trim()||p)return;let t=r.trim();a(""),T(t,"",!0),await O(t)},O=async e=>{let t=e.toLowerCase();b(!0);try{if("clear"===t){d([]),b(!1);return}if("help"===t)T(e,"Available commands:\n- clear: Clear the console\n- help: Show this help message\n- theme [name]: Change console theme (shadowrunBarren, matrix, cyberpunk, terminal)\n- settings: Open settings panel\n- /session create [name]: Create a new game session (GM only)\n- /session join [id]: Join an existing session\n- /dm dashboard: Open DM review dashboard (GM only)\n- /ai [message]: Request AI response with DM review\n- /scene [description]: Set a new scene\n- /roll [dice]: Roll dice (e.g., /roll 3d6)\n- /summon [character]: Summon an NPC\n- /echo [message]: Display a message to all players",!1);else if(t.startsWith("theme ")){let s=t.replace("theme ","");if(m[s]){let t={...C,theme:s};I(t),T(e,"Theme changed to ".concat(m[s].name),!1)}else T(e,"Theme not found. Available themes: ".concat(Object.keys(m).join(", ")),!1)}else if("settings"===t)y(!0),T(e,"Opening settings panel...",!1);else if(t.startsWith("/session "))await A(e);else if("/dm dashboard"===t)S?N?(f(!0),T(e,"Opening DM Review Dashboard...",!1)):T(e,"Error: You must be in a session to access the DM dashboard.",!1):T(e,"Error: Only Game Masters can access the DM dashboard.",!1);else if(t.startsWith("/ai "))await R(e);else if(t.startsWith("/scene ")){let t=e.substring(7);T(e,"Setting scene: ".concat(t,"\nThe GM is describing the scene..."),!1)}else if(t.startsWith("/roll ")){let t=e.substring(6);T(e,"Rolling ".concat(t,"...\nResult: 14 (simulated roll)"),!1)}else T(e,"Unknown command: ".concat(e,'\nType "help" for available commands.'),!1)}catch(t){console.error("Error processing command:",t),T(e,"Error: ".concat(t instanceof Error?t.message:"Unknown error processing command"),!1)}finally{b(!1)}},P=m[C.theme],L=(null===(e=g.find(e=>e.id===C.fontSize))||void 0===e?void 0:e.class)||"text-base";return(0,n.jsxs)("div",{className:"min-h-screen flex flex-col ".concat(P.background),children:[(0,n.jsx)("header",{className:"p-2 border-b border-red-900",children:(0,n.jsxs)("div",{className:"flex justify-between items-center",children:[(0,n.jsx)("h1",{className:"".concat(P.prompt," font-mono font-bold"),children:"SHADOWRUN MATRIX INTERFACE"}),(0,n.jsx)("div",{className:"flex items-center gap-2",children:(0,n.jsx)("button",{onClick:()=>y(!0),className:"px-3 py-1 rounded ".concat(P.accent," hover:opacity-80"),children:"Settings"})})]})}),(0,n.jsx)("div",{ref:_,className:"flex-1 p-4 overflow-y-auto font-mono ".concat(L),onClick:()=>{var e;return null===(e=k.current)||void 0===e?void 0:e.focus()},children:i.map((e,t)=>(0,n.jsxs)("div",{className:"mb-4",children:[e.command&&(0,n.jsxs)("div",{className:"flex",children:[(0,n.jsx)("span",{className:"".concat(P.prompt," mr-2"),children:u}),(0,n.jsx)("span",{className:P.text,children:e.command})]}),(0,n.jsxs)("div",{className:"pl-4 whitespace-pre-wrap ".concat(P.secondaryText),children:[e.output,e.isProcessing&&(0,n.jsx)("span",{className:"streaming-cursor ml-1"})]})]},t))}),(0,n.jsx)("form",{onSubmit:D,className:"p-2 border-t border-red-900",children:(0,n.jsxs)("div",{className:"flex items-center ".concat(P.input," p-2 rounded"),children:[(0,n.jsx)("span",{className:"".concat(P.prompt," mr-2"),children:u}),(0,n.jsx)("input",{ref:k,type:"text",value:r,onChange:e=>a(e.target.value),className:"flex-1 bg-transparent outline-none ".concat(P.inputText),disabled:p,placeholder:p?"Processing...":"Type a command..."})]})}),v&&(0,n.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50",children:(0,n.jsxs)("div",{className:"".concat(P.secondaryBackground," p-6 rounded-lg max-w-md w-full"),children:[(0,n.jsx)("h2",{className:"".concat(P.prompt," text-xl font-bold mb-4"),children:"Console Settings"}),(0,n.jsxs)("div",{className:"mb-4",children:[(0,n.jsx)("label",{className:"".concat(P.text," block mb-2"),children:"Theme"}),(0,n.jsx)("select",{value:C.theme,onChange:e=>I({...C,theme:e.target.value}),className:"w-full p-2 bg-gray-800 text-white rounded",children:Object.entries(m).map(e=>{let[t,s]=e;return(0,n.jsx)("option",{value:t,children:s.name},t)})})]}),(0,n.jsxs)("div",{className:"mb-4",children:[(0,n.jsx)("label",{className:"".concat(P.text," block mb-2"),children:"Font Size"}),(0,n.jsx)("select",{value:C.fontSize,onChange:e=>I({...C,fontSize:e.target.value}),className:"w-full p-2 bg-gray-800 text-white rounded",children:g.map(e=>(0,n.jsx)("option",{value:e.id,children:e.name},e.id))})]}),(0,n.jsx)("div",{className:"flex justify-end mt-6",children:(0,n.jsx)("button",{onClick:()=>y(!1),className:"px-4 py-2 rounded ".concat(P.accent),children:"Close"})})]})}),j&&N&&(0,n.jsx)(x,{sessionId:N,isVisible:j,onClose:()=>f(!1)})]})}function h(){return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(a(),{children:[(0,n.jsx)("title",{children:"Shadowrun Interface | Console"}),(0,n.jsx)("meta",{name:"description",content:"Shadowrun RPG terminal interface"})]}),(0,n.jsx)(i.CH,{children:(0,n.jsx)("div",{className:"min-h-screen bg-sr-dark flex flex-col",children:(0,n.jsx)(u,{})})}),(0,n.jsx)(i.tj,{children:(0,n.jsx)(o.N1,{})})]})}}},function(e){e.O(0,[703,888,774,179],function(){return e(e.s=5180)}),_N_E=e.O()}]);