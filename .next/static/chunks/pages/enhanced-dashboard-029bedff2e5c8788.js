(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[604],{9258:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/enhanced-dashboard",function(){return t(3437)}])},3437:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return EnhancedDashboard}});var a=t(5893),n=t(7294),r=t(9008),l=t.n(r),c=t(1664),i=t.n(c),o=t(8901),d=t(4123),x=t(76);function SessionManager(e){let{onSessionJoined:s,currentSession:t}=e,{user:r}=(0,o.aF)(),[l,c]=(0,n.useState)([]),[i,d]=(0,n.useState)(!1),[h,m]=(0,n.useState)(null),[u,b]=(0,n.useState)(!1),[g,p]=(0,n.useState)(null),[j,y]=(0,n.useState)({name:"",maxPlayers:6,password:"",isPrivate:!1}),[N,v]=(0,n.useState)("");(0,n.useEffect)(()=>{loadActiveSessions()},[]);let loadActiveSessions=async()=>{try{b(!0);let e=await x.FW.getActiveSessions();c(e)}catch(e){console.error("Failed to load sessions:",e),p("Failed to load active sessions")}finally{b(!1)}},handleCreateSession=async e=>{if(e.preventDefault(),!j.name.trim()){p("Session name is required");return}try{b(!0),p(null);let e=await x.FW.createSession(j.name,j.maxPlayers);d(!1),y({name:"",maxPlayers:6,password:"",isPrivate:!1}),s(e)}catch(e){console.error("Failed to create session:",e),p(e instanceof Error?e.message:"Failed to create session")}finally{b(!1)}},handleJoinSession=async e=>{try{b(!0),p(null);let t=await x.FW.joinSession(e,N||void 0);m(null),v(""),s(t)}catch(e){console.error("Failed to join session:",e),p(e instanceof Error?e.message:"Failed to join session")}finally{b(!1)}},handleLeaveSession=async()=>{if(t)try{b(!0),await x.FW.leaveSession(t.id),s(null),loadActiveSessions()}catch(e){console.error("Failed to leave session:",e),p(e instanceof Error?e.message:"Failed to leave session")}finally{b(!1)}};return t?(0,a.jsxs)("div",{className:"bg-black bg-opacity-70 border border-red-900 border-opacity-40 rounded-lg p-6 text-white",children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-green-500 mb-4",children:"Current Session"}),(0,a.jsxs)("div",{className:"space-y-2 mb-4",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-300",children:"Name:"}),(0,a.jsx)("span",{className:"text-green-400",children:t.name})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-300",children:"Players:"}),(0,a.jsxs)("span",{className:"text-green-400",children:[t.playerCount,"/",t.maxPlayers]})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-300",children:"Status:"}),(0,a.jsx)("span",{className:"".concat("active"===t.gameState?"text-green-400":"paused"===t.gameState?"text-yellow-400":"text-gray-400"),children:t.gameState.toUpperCase()})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-300",children:"Role:"}),(0,a.jsx)("span",{className:"text-red-400",children:t.isGM?"Game Master":"Player"})]})]}),(0,a.jsx)("button",{onClick:handleLeaveSession,disabled:u,className:"w-full bg-red-700 text-red-100 px-4 py-2 rounded hover:bg-red-600 disabled:opacity-50",children:u?"Leaving...":"Leave Session"})]}):(0,a.jsxs)("div",{className:"bg-black bg-opacity-70 border border-red-900 border-opacity-40 rounded-lg p-6 text-white",children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-green-500 mb-4",children:"Session Management"}),g&&(0,a.jsxs)("div",{className:"bg-red-900 bg-opacity-50 border border-red-500 p-3 rounded mb-4",children:[(0,a.jsx)("p",{className:"text-red-200",children:g}),(0,a.jsx)("button",{onClick:()=>p(null),className:"text-red-400 hover:text-red-200 mt-2 text-sm",children:"Dismiss"})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("button",{onClick:()=>d(!0),className:"w-full bg-green-700 text-green-100 px-4 py-2 rounded hover:bg-green-600",children:"Create New Session"}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-red-300",children:"Active Sessions"}),(0,a.jsx)("button",{onClick:loadActiveSessions,disabled:u,className:"text-sm text-blue-400 hover:text-blue-200 disabled:opacity-50",children:u?"Loading...":"Refresh"})]}),0===l.length?(0,a.jsx)("p",{className:"text-gray-400 italic",children:"No active sessions found"}):(0,a.jsx)("div",{className:"space-y-2",children:l.map(e=>(0,a.jsx)("div",{className:"border border-gray-700 rounded p-3",children:(0,a.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-semibold text-white",children:e.name}),(0,a.jsxs)("p",{className:"text-sm text-gray-400",children:[e.playerCount,"/",e.maxPlayers," players • ",e.gameState]})]}),(0,a.jsx)("button",{onClick:()=>m(e.id),disabled:e.playerCount>=e.maxPlayers,className:"bg-blue-700 text-blue-100 px-3 py-1 rounded text-sm hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed",children:e.playerCount>=e.maxPlayers?"Full":"Join"})]})},e.id))})]})]}),i&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50",children:(0,a.jsxs)("div",{className:"bg-gray-900 p-6 rounded-lg max-w-md w-full mx-4",children:[(0,a.jsx)("h3",{className:"text-xl font-bold text-green-500 mb-4",children:"Create Session"}),(0,a.jsxs)("form",{onSubmit:handleCreateSession,className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-gray-300 mb-2",children:"Session Name"}),(0,a.jsx)("input",{type:"text",value:j.name,onChange:e=>y({...j,name:e.target.value}),className:"w-full p-2 bg-gray-800 text-white rounded border border-gray-600",placeholder:"Enter session name...",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-gray-300 mb-2",children:"Max Players"}),(0,a.jsx)("select",{value:j.maxPlayers,onChange:e=>y({...j,maxPlayers:parseInt(e.target.value)}),className:"w-full p-2 bg-gray-800 text-white rounded border border-gray-600",children:[2,3,4,5,6,7,8].map(e=>(0,a.jsxs)("option",{value:e,children:[e," players"]},e))})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-2 mt-6",children:[(0,a.jsx)("button",{type:"button",onClick:()=>d(!1),className:"px-4 py-2 bg-gray-700 text-gray-300 rounded hover:bg-gray-600",children:"Cancel"}),(0,a.jsx)("button",{type:"submit",disabled:u,className:"px-4 py-2 bg-green-700 text-green-100 rounded hover:bg-green-600 disabled:opacity-50",children:u?"Creating...":"Create Session"})]})]})]})}),h&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50",children:(0,a.jsxs)("div",{className:"bg-gray-900 p-6 rounded-lg max-w-md w-full mx-4",children:[(0,a.jsx)("h3",{className:"text-xl font-bold text-blue-500 mb-4",children:"Join Session"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-gray-300 mb-2",children:"Password (if required)"}),(0,a.jsx)("input",{type:"password",value:N,onChange:e=>v(e.target.value),className:"w-full p-2 bg-gray-800 text-white rounded border border-gray-600",placeholder:"Enter password..."})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-2 mt-6",children:[(0,a.jsx)("button",{onClick:()=>m(null),className:"px-4 py-2 bg-gray-700 text-gray-300 rounded hover:bg-gray-600",children:"Cancel"}),(0,a.jsx)("button",{onClick:()=>handleJoinSession(h),disabled:u,className:"px-4 py-2 bg-blue-700 text-blue-100 rounded hover:bg-blue-600 disabled:opacity-50",children:u?"Joining...":"Join Session"})]})]})]})})]})}var h=t(7520);function EnhancedDashboard(){let{user:e}=(0,o.aF)(),[s,t]=(0,n.useState)(null),[r,c]=(0,n.useState)(null),[x,m]=(0,n.useState)({activeSessions:0,onlineUsers:0,serverStatus:"Online"}),[u,b]=(0,n.useState)("overview");return(0,n.useEffect)(()=>{let e=localStorage.getItem("shadowrun-current-character");if(e)try{c(JSON.parse(e))}catch(e){console.error("Failed to load saved character:",e)}},[]),(0,n.useEffect)(()=>{r&&localStorage.setItem("shadowrun-current-character",JSON.stringify(r))},[r]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(l(),{children:[(0,a.jsx)("title",{children:"Shadowrun Interface | Enhanced Dashboard"}),(0,a.jsx)("meta",{name:"description",content:"Enhanced Shadowrun RPG dashboard with session management and character sheets"})]}),(0,a.jsxs)("main",{className:"min-h-screen bg-gray-950",children:[(0,a.jsx)(d.CH,{children:(0,a.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,a.jsx)("header",{className:"mb-8",children:(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("h1",{className:"text-3xl font-bold text-green-500 font-mono",children:[(0,a.jsx)("span",{className:"text-red-400",children:">"})," ENHANCED OPERATOR DASHBOARD"]}),(0,a.jsxs)("p",{className:"text-gray-400 mt-2",children:["Logged in as ",(0,a.jsx)("span",{className:"text-red-400",children:(null==e?void 0:e.fullName)||(null==e?void 0:e.username)||"Unknown Runner"})]}),s&&(0,a.jsxs)("p",{className:"text-green-400 text-sm mt-1",children:["\uD83D\uDD17 Connected to: ",s.name," (",s.isGM?"GM":"Player",")"]})]}),(0,a.jsxs)("div",{className:"text-right text-sm",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,a.jsx)("span",{className:"text-gray-400",children:"Server Status:"}),(0,a.jsx)("span",{className:"font-bold ".concat("Online"===x.serverStatus?"text-green-400":"Maintenance"===x.serverStatus?"text-yellow-400":"text-red-400"),children:x.serverStatus})]}),(0,a.jsxs)("div",{className:"text-gray-400",children:[x.activeSessions," active sessions • ",x.onlineUsers," users online"]})]})]})}),(0,a.jsx)("nav",{className:"mb-6",children:(0,a.jsx)("div",{className:"flex space-x-4 border-b border-red-900 border-opacity-40",children:[{id:"overview",label:"Overview",icon:"\uD83D\uDCCA"},{id:"sessions",label:"Sessions",icon:"\uD83C\uDFAE"},{id:"character",label:"Character",icon:"\uD83C\uDFB2"}].map(e=>(0,a.jsxs)("button",{onClick:()=>b(e.id),className:"px-4 py-2 font-medium border-b-2 transition-colors ".concat(u===e.id?"text-green-500 border-green-500":"text-gray-400 border-transparent hover:text-white hover:border-gray-600"),children:[(0,a.jsx)("span",{className:"mr-2",children:e.icon}),e.label]},e.id))})}),(0,a.jsxs)("div",{className:"space-y-6",children:["overview"===u&&(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{className:"bg-black bg-opacity-70 border border-red-900 border-opacity-40 rounded-lg p-6",children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-green-500 mb-4",children:"\uD83D\uDE80 Quick Actions"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,a.jsx)(i(),{href:"/enhanced-console",className:"bg-green-700 border border-green-500 text-green-100 px-4 py-3 rounded text-center hover:bg-green-600 transition-colors block",children:"\uD83D\uDDA5️ Launch Enhanced Console"}),(0,a.jsx)("button",{onClick:()=>b("sessions"),className:"bg-blue-700 border border-blue-500 text-blue-100 px-4 py-3 rounded text-center hover:bg-blue-600 transition-colors",children:"\uD83C\uDFAE Manage Sessions"}),(0,a.jsx)("button",{onClick:()=>b("character"),className:"bg-purple-700 border border-purple-500 text-purple-100 px-4 py-3 rounded text-center hover:bg-purple-600 transition-colors",children:"\uD83C\uDFB2 Character Sheet"}),(0,a.jsx)(i(),{href:"/dice-roller",className:"bg-red-700 border border-red-500 text-red-100 px-4 py-3 rounded text-center hover:bg-red-600 transition-colors block",children:"\uD83C\uDFAF Dice Roller"})]})]}),(0,a.jsxs)("div",{className:"bg-black bg-opacity-70 border border-red-900 border-opacity-40 rounded-lg p-6",children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-green-500 mb-4",children:"\uD83D\uDCE1 Session Status"}),s?(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-400",children:"Session:"}),(0,a.jsx)("span",{className:"text-white font-medium",children:s.name})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-400",children:"Role:"}),(0,a.jsx)("span",{className:"font-medium ".concat(s.isGM?"text-red-400":"text-blue-400"),children:s.isGM?"Game Master":"Player"})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-400",children:"Players:"}),(0,a.jsxs)("span",{className:"text-green-400",children:[s.playerCount,"/",s.maxPlayers]})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-400",children:"Status:"}),(0,a.jsx)("span",{className:"font-medium ".concat("active"===s.gameState?"text-green-400":"paused"===s.gameState?"text-yellow-400":"text-gray-400"),children:s.gameState.toUpperCase()})]})]}):(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)("p",{className:"text-gray-400 mb-4",children:"Not connected to any session"}),(0,a.jsx)("button",{onClick:()=>b("sessions"),className:"bg-green-700 text-green-100 px-4 py-2 rounded hover:bg-green-600",children:"Join or Create Session"})]})]}),(0,a.jsxs)("div",{className:"bg-black bg-opacity-70 border border-red-900 border-opacity-40 rounded-lg p-6",children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-green-500 mb-4",children:"\uD83C\uDFAD Active Character"}),r?(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-gray-400",children:"Name:"}),(0,a.jsx)("span",{className:"text-white font-medium",children:r.name})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-400",children:"Archetype:"}),(0,a.jsx)("span",{className:"text-blue-400",children:r.background.archetype})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-400",children:"Metatype:"}),(0,a.jsx)("span",{className:"text-purple-400",children:r.metatype})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-400",children:"Edge:"}),(0,a.jsxs)("span",{className:"text-yellow-400",children:[r.attributes.edge,"/3"]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 mt-4",children:[(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-sm text-gray-400",children:"Physical"}),(0,a.jsxs)("div",{className:"text-lg font-bold text-red-400",children:[r.condition.physical.current,"/",r.condition.physical.max]})]}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-sm text-gray-400",children:"Stun"}),(0,a.jsxs)("div",{className:"text-lg font-bold text-yellow-400",children:[r.condition.stun.current,"/",r.condition.stun.max]})]})]})]}):(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)("p",{className:"text-gray-400 mb-4",children:"No active character"}),(0,a.jsx)("button",{onClick:()=>b("character"),className:"bg-purple-700 text-purple-100 px-4 py-2 rounded hover:bg-purple-600",children:"Create Character"})]})]}),(0,a.jsxs)("div",{className:"bg-black bg-opacity-70 border border-red-900 border-opacity-40 rounded-lg p-6",children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-green-500 mb-4",children:"\uD83D\uDCDC Recent Activity"}),(0,a.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-400",children:"Session joined"}),(0,a.jsx)("span",{className:"text-gray-500",children:"2 hours ago"})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-400",children:"Character updated"}),(0,a.jsx)("span",{className:"text-gray-500",children:"3 hours ago"})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-400",children:"Dice rolled: 14 hits"}),(0,a.jsx)("span",{className:"text-gray-500",children:"4 hours ago"})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-400",children:"Console accessed"}),(0,a.jsx)("span",{className:"text-gray-500",children:"5 hours ago"})]})]})]})]}),"sessions"===u&&(0,a.jsx)("div",{className:"max-w-4xl mx-auto",children:(0,a.jsx)(SessionManager,{onSessionJoined:e=>{t(e),e&&b("overview")},currentSession:s})}),"character"===u&&(0,a.jsx)("div",{className:"max-w-6xl mx-auto",children:(0,a.jsx)(h.Z,{character:r||void 0,onCharacterUpdate:e=>{c(e)}})})]}),(0,a.jsx)("footer",{className:"mt-12 pt-8 border-t border-red-900 border-opacity-40",children:(0,a.jsxs)("div",{className:"flex justify-between items-center text-sm text-gray-400",children:[(0,a.jsx)("div",{children:"Shadowrun Interface v2.0 Enhanced • Built for runners, by runners"}),(0,a.jsxs)("div",{className:"flex space-x-4",children:[(0,a.jsx)(i(),{href:"/console",className:"hover:text-white",children:"Legacy Console"}),(0,a.jsx)(i(),{href:"/enhanced-console",className:"hover:text-white",children:"Enhanced Console"}),(0,a.jsx)(i(),{href:"/help",className:"hover:text-white",children:"Help"})]})]})})]})}),(0,a.jsx)(d.tj,{children:(0,a.jsx)(o.N1,{})})]})]})}},76:function(e,s,t){"use strict";t.d(s,{FW:function(){return c},du:function(){return ShadowrunWebSocket}});var a=t(7066),n=t(3454);let r=n.env.NEXT_PUBLIC_API_URL||"http://localhost:5000",l=a.Z.create({baseURL:r,timeout:1e4,headers:{"Content-Type":"application/json"}});l.interceptors.request.use(e=>{let s=localStorage.getItem("shadowrun-session-token");return s&&(e.headers.Authorization="Bearer ".concat(s)),e},e=>Promise.reject(e)),l.interceptors.response.use(e=>e,e=>{var s;return console.error("API Error:",(null===(s=e.response)||void 0===s?void 0:s.data)||e.message),Promise.reject(e)});let c={async createSession(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:6,t=await l.post("/sessions",{name:e,maxPlayers:s});return t.data},async joinSession(e,s){let t=await l.post("/sessions/".concat(e,"/join"),{password:s});return t.data},async leaveSession(e){await l.post("/sessions/".concat(e,"/leave"))},async getActiveSessions(){let e=await l.get("/sessions");return e.data},async getSessionInfo(e){let s=await l.get("/sessions/".concat(e));return s.data}};let ShadowrunWebSocket=class ShadowrunWebSocket{connect(e,s,t){this.sessionId=e,this.onMessageCallback=s,this.onConnectionCallback=t;let a="".concat(r.replace("http","ws"),"/ws/").concat(e);try{this.ws=new WebSocket(a),this.ws.onopen=()=>{var e;console.log("WebSocket connected"),this.reconnectAttempts=0,null===(e=this.onConnectionCallback)||void 0===e||e.call(this,!0)},this.ws.onmessage=e=>{try{var s;let t=JSON.parse(e.data);null===(s=this.onMessageCallback)||void 0===s||s.call(this,t)}catch(e){console.error("Failed to parse WebSocket message:",e)}},this.ws.onclose=()=>{var e;console.log("WebSocket disconnected"),null===(e=this.onConnectionCallback)||void 0===e||e.call(this,!1),this.attemptReconnect()},this.ws.onerror=e=>{console.error("WebSocket error:",e)}}catch(e){var n;console.error("Failed to create WebSocket connection:",e),null===(n=this.onConnectionCallback)||void 0===n||n.call(this,!1)}}attemptReconnect(){this.reconnectAttempts<this.maxReconnectAttempts&&this.sessionId&&(this.reconnectAttempts++,console.log("Attempting to reconnect (".concat(this.reconnectAttempts,"/").concat(this.maxReconnectAttempts,")...")),setTimeout(()=>{this.sessionId&&this.onMessageCallback&&this.connect(this.sessionId,this.onMessageCallback,this.onConnectionCallback)},this.reconnectDelay*this.reconnectAttempts))}send(e){this.ws&&this.ws.readyState===WebSocket.OPEN?this.ws.send(JSON.stringify(e)):console.warn("WebSocket not connected, cannot send message")}disconnect(){this.ws&&(this.ws.close(),this.ws=null),this.sessionId=null,this.onMessageCallback=void 0,this.onConnectionCallback=void 0}isConnected(){var e;return(null===(e=this.ws)||void 0===e?void 0:e.readyState)===WebSocket.OPEN}constructor(){this.ws=null,this.sessionId=null,this.reconnectAttempts=0,this.maxReconnectAttempts=5,this.reconnectDelay=1e3}}}},function(e){e.O(0,[703,664,520,774,888,179],function(){return e(e.s=9258)}),_N_E=e.O()}]);