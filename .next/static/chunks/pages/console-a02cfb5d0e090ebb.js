(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[436],{5180:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/console",function(){return s(8730)}])},8730:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return ConsolePage}});var n=s(5893),a=s(9008),r=s.n(a),o=s(4123),i=s(8901),l=s(7294),c=s(7066);let d="http://localhost:5000";function DmDashboard(e){let{sessionId:t,isVisible:s,onClose:a}=e,{user:r}=(0,i.aF)(),[o,x]=(0,l.useState)({items:[],pagination:{page:1,per_page:20,total:0,pages:0,has_next:!1,has_prev:!1}}),[m,h]=(0,l.useState)([]),[g,u]=(0,l.useState)(null),[p,b]=(0,l.useState)(null),[y,v]=(0,l.useState)(new Set),[f,j]=(0,l.useState)(""),[N,w]=(0,l.useState)(""),[S,E]=(0,l.useState)(!1),[T,k]=(0,l.useState)("pending"),[_,C]=(0,l.useState)(1),[R,A]=(0,l.useState)(null),[I,P]=(0,l.useState)(""),D=(0,l.useRef)(null),H=(0,l.useCallback)(()=>{D.current&&clearInterval(D.current),D.current=setInterval(()=>{s&&r&&(fetchPendingResponses(),fetchNotifications(),fetchAnalytics())},5e3)},[s,r,t,_,R,I]),O=(0,l.useCallback)(()=>{D.current&&(clearInterval(D.current),D.current=null)},[]);(0,l.useEffect)(()=>(s&&r?(fetchPendingResponses(),fetchNotifications(),fetchAnalytics(),H()):O(),()=>O()),[s,r,t,_,R,I,H,O]),(0,l.useEffect)(()=>{let handleKeyPress=e=>{s&&p&&("a"===e.key&&e.altKey?(e.preventDefault(),handleReview("approve")):"r"===e.key&&e.altKey?(e.preventDefault(),handleReview("reject")):"e"===e.key&&e.altKey?(e.preventDefault(),handleReview("edit")):"Escape"===e.key&&(b(null),v(new Set)))};return window.addEventListener("keydown",handleKeyPress),()=>window.removeEventListener("keydown",handleKeyPress)},[s,p]);let fetchPendingResponses=async()=>{try{E(!0);let e=new URLSearchParams({user_id:(null==r?void 0:r.id)||"",page:_.toString(),per_page:"20"});R&&e.append("priority",R.toString()),I&&e.append("response_type",I);let s=await c.Z.get("".concat(d,"/api/session/").concat(t,"/pending-responses?").concat(e));x(s.data)}catch(e){console.error("Error fetching pending responses:",e)}finally{E(!1)}},fetchNotifications=async()=>{try{let e=await c.Z.get("".concat(d,"/api/session/").concat(t,"/dm/notifications?user_id=").concat(null==r?void 0:r.id));h(e.data)}catch(e){console.error("Error fetching notifications:",e)}},fetchAnalytics=async()=>{try{let e=await c.Z.get("".concat(d,"/api/session/").concat(t,"/dm/analytics?user_id=").concat(null==r?void 0:r.id));u(e.data)}catch(e){console.error("Error fetching analytics:",e)}},handleReview=async e=>{if(p&&r)try{E(!0),await c.Z.post("".concat(d,"/api/session/").concat(t,"/pending-response/").concat(p.id,"/review"),{user_id:r.id,action:e,final_response:"edit"===e?f:void 0,dm_notes:N}),await fetchPendingResponses(),await fetchNotifications(),await fetchAnalytics(),b(null),j(""),w("")}catch(e){console.error("Error reviewing response:",e)}finally{E(!1)}},handleBulkReview=async e=>{if(0!==y.size&&r)try{E(!0),await c.Z.post("".concat(d,"/api/session/").concat(t,"/pending-responses/bulk"),{user_id:r.id,action:e,response_ids:Array.from(y),dm_notes:N}),await fetchPendingResponses(),await fetchNotifications(),await fetchAnalytics(),v(new Set),w("")}catch(e){console.error("Error bulk reviewing responses:",e)}finally{E(!1)}},markNotificationRead=async e=>{try{await c.Z.post("".concat(d,"/api/session/").concat(t,"/dm/notifications/").concat(e,"/mark-read"),{user_id:null==r?void 0:r.id}),await fetchNotifications(),await fetchAnalytics()}catch(e){console.error("Error marking notification as read:",e)}},toggleResponseSelection=e=>{let t=new Set(y);t.has(e)?t.delete(e):t.add(e),v(t)},getPriorityColor=e=>{switch(e){case 3:return"text-red-400 bg-red-900";case 2:return"text-yellow-400 bg-yellow-900";default:return"text-green-400 bg-green-900"}},getPriorityLabel=e=>{switch(e){case 3:return"HIGH";case 2:return"MEDIUM";default:return"LOW"}},formatTimestamp=e=>new Date(e).toLocaleString();return s?(0,n.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50",children:(0,n.jsxs)("div",{className:"bg-gray-900 text-green-400 p-6 rounded-lg max-w-6xl w-full max-h-[90vh] overflow-y-auto",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,n.jsx)("h2",{className:"text-2xl font-bold text-red-400",children:"DM REVIEW DASHBOARD"}),(0,n.jsx)("button",{onClick:a,className:"text-red-400 hover:text-red-300 text-xl font-bold",children:"\xd7"})]}),(0,n.jsxs)("div",{className:"flex mb-6 border-b border-gray-700",children:[(0,n.jsxs)("button",{className:"px-4 py-2 font-mono ".concat("pending"===T?"text-green-400 border-b-2 border-green-400":"text-gray-400 hover:text-green-400"),onClick:()=>k("pending"),children:["PENDING RESPONSES (",o.items.length,")"]}),(0,n.jsxs)("button",{className:"px-4 py-2 font-mono ".concat("notifications"===T?"text-green-400 border-b-2 border-green-400":"text-gray-400 hover:text-green-400"),onClick:()=>k("notifications"),children:["NOTIFICATIONS (",m.length,")"]}),(0,n.jsx)("button",{className:"px-4 py-2 font-mono ".concat("analytics"===T?"text-green-400 border-b-2 border-green-400":"text-gray-400 hover:text-green-400"),onClick:()=>k("analytics"),children:"ANALYTICS"})]}),"pending"===T&&(0,n.jsxs)("div",{className:"space-y-6",children:[(0,n.jsxs)("div",{className:"bg-gray-800 p-4 rounded border border-gray-600",children:[(0,n.jsxs)("div",{className:"flex flex-wrap gap-4 items-center justify-between",children:[(0,n.jsxs)("div",{className:"flex gap-4 items-center",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-xs text-gray-400 mb-1",children:"PRIORITY FILTER"}),(0,n.jsxs)("select",{value:R||"",onChange:e=>{A(e.target.value?parseInt(e.target.value):null),C(1)},className:"bg-gray-700 text-green-400 p-2 rounded border border-gray-600 text-sm",children:[(0,n.jsx)("option",{value:"",children:"ALL"}),(0,n.jsx)("option",{value:"3",children:"HIGH"}),(0,n.jsx)("option",{value:"2",children:"MEDIUM"}),(0,n.jsx)("option",{value:"1",children:"LOW"})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-xs text-gray-400 mb-1",children:"TYPE FILTER"}),(0,n.jsxs)("select",{value:I,onChange:e=>{P(e.target.value),C(1)},className:"bg-gray-700 text-green-400 p-2 rounded border border-gray-600 text-sm",children:[(0,n.jsx)("option",{value:"",children:"ALL TYPES"}),(0,n.jsx)("option",{value:"narrative",children:"NARRATIVE"}),(0,n.jsx)("option",{value:"dice_roll",children:"DICE ROLL"}),(0,n.jsx)("option",{value:"npc_action",children:"NPC ACTION"})]})]})]}),y.size>0&&(0,n.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,n.jsxs)("span",{className:"text-sm text-gray-400",children:[y.size," selected"]}),(0,n.jsx)("button",{onClick:()=>handleBulkReview("approve"),className:"px-3 py-1 bg-green-600 hover:bg-green-700 text-white text-sm rounded",children:"Bulk Approve"}),(0,n.jsx)("button",{onClick:()=>handleBulkReview("reject"),className:"px-3 py-1 bg-red-600 hover:bg-red-700 text-white text-sm rounded",children:"Bulk Reject"})]})]}),(0,n.jsx)("div",{className:"mt-2 text-xs text-gray-500",children:"Shortcuts: Alt+A (approve), Alt+R (reject), Alt+E (edit), Esc (clear selection)"})]}),(0,n.jsx)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:(0,n.jsxs)("div",{className:"pending-responses-list",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,n.jsx)("h3",{className:"text-lg font-mono text-yellow-400",children:"PENDING REVIEWS"}),o.items.length>0&&(0,n.jsx)("button",{onClick:()=>{y.size===o.items.length?v(new Set):v(new Set(o.items.map(e=>e.id)))},className:"text-xs text-blue-400 hover:text-blue-300",children:y.size===o.items.length?"Deselect All":"Select All"})]}),S?(0,n.jsx)("div",{className:"text-center py-8",children:(0,n.jsx)("div",{className:"text-green-400",children:"Loading..."})}):0===o.items.length?(0,n.jsx)("div",{className:"text-center py-8 text-gray-400",children:"No pending responses to review"}):(0,n.jsx)("div",{className:"space-y-4",children:o.items.map(e=>(0,n.jsx)("div",{className:"p-4 border rounded transition-colors ".concat((null==p?void 0:p.id)===e.id?"border-green-400 bg-green-900 bg-opacity-20":"border-gray-600 hover:border-gray-500"),children:(0,n.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,n.jsx)("input",{type:"checkbox",checked:y.has(e.id),onChange:t=>{t.stopPropagation(),toggleResponseSelection(e.id)},className:"mt-1 text-green-400 bg-gray-700 border-gray-600 rounded focus:ring-green-500"}),(0,n.jsxs)("div",{className:"flex-1 cursor-pointer",onClick:()=>{b(e),j(e.ai_response),w("")},children:[(0,n.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsx)("span",{className:"px-2 py-1 text-xs rounded ".concat(getPriorityColor(e.priority)),children:getPriorityLabel(e.priority)}),(0,n.jsx)("span",{className:"text-blue-400 text-sm font-mono",children:e.response_type.toUpperCase()})]}),(0,n.jsx)("span",{className:"text-xs text-gray-400",children:formatTimestamp(e.created_at)})]}),(0,n.jsxs)("div",{className:"text-sm text-gray-300 mb-2",children:[(0,n.jsx)("strong",{children:"Player:"})," ",e.user_id]}),(0,n.jsxs)("div",{className:"text-sm text-gray-300",children:[(0,n.jsx)("strong",{children:"Context:"})," ",e.context.substring(0,100),"..."]})]})]})},e.id))})]})}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h3",{className:"text-lg font-mono mb-4 text-yellow-400",children:"REVIEW PANEL"}),p?(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)("div",{className:"p-4 border border-gray-600 rounded",children:[(0,n.jsx)("h4",{className:"text-green-400 font-mono mb-2",children:"PLAYER CONTEXT"}),(0,n.jsx)("div",{className:"text-gray-300 text-sm bg-gray-800 p-3 rounded",children:p.context})]}),(0,n.jsxs)("div",{className:"p-4 border border-gray-600 rounded",children:[(0,n.jsx)("h4",{className:"text-green-400 font-mono mb-2",children:"AI RESPONSE"}),(0,n.jsx)("div",{className:"text-gray-300 text-sm bg-gray-800 p-3 rounded",children:p.ai_response})]}),(0,n.jsxs)("div",{className:"p-4 border border-gray-600 rounded",children:[(0,n.jsx)("h4",{className:"text-green-400 font-mono mb-2",children:"EDIT RESPONSE (Optional)"}),(0,n.jsx)("textarea",{value:f,onChange:e=>j(e.target.value),className:"w-full h-32 bg-gray-800 text-gray-300 p-3 rounded border border-gray-600 focus:border-green-400 focus:outline-none text-sm",placeholder:"Edit the AI response or leave as-is to approve..."})]}),(0,n.jsxs)("div",{className:"p-4 border border-gray-600 rounded",children:[(0,n.jsx)("h4",{className:"text-green-400 font-mono mb-2",children:"DM NOTES (Optional)"}),(0,n.jsx)("textarea",{value:N,onChange:e=>w(e.target.value),className:"w-full h-20 bg-gray-800 text-gray-300 p-3 rounded border border-gray-600 focus:border-green-400 focus:outline-none text-sm",placeholder:"Add notes for the player..."})]}),(0,n.jsxs)("div",{className:"flex space-x-3",children:[(0,n.jsx)("button",{onClick:()=>handleReview("approve"),disabled:S,className:"px-4 py-2 bg-green-700 hover:bg-green-600 text-white rounded font-mono disabled:opacity-50",children:"APPROVE"}),(0,n.jsx)("button",{onClick:()=>handleReview("edit"),disabled:S,className:"px-4 py-2 bg-yellow-700 hover:bg-yellow-600 text-white rounded font-mono disabled:opacity-50",children:"EDIT & APPROVE"}),(0,n.jsx)("button",{onClick:()=>handleReview("reject"),disabled:S,className:"px-4 py-2 bg-red-700 hover:bg-red-600 text-white rounded font-mono disabled:opacity-50",children:"REJECT"})]})]}):(0,n.jsx)("div",{className:"text-center py-8 text-gray-400",children:"Select a pending response to review"})]})]}),"notifications"===T&&(0,n.jsxs)("div",{children:[(0,n.jsx)("h3",{className:"text-lg font-mono mb-4 text-yellow-400",children:"NOTIFICATIONS"}),0===m.length?(0,n.jsx)("div",{className:"text-center py-8 text-gray-400",children:"No unread notifications"}):(0,n.jsx)("div",{className:"space-y-3",children:m.map(e=>(0,n.jsx)("div",{className:"p-4 border border-gray-600 rounded hover:border-gray-500 transition-colors",children:(0,n.jsxs)("div",{className:"flex justify-between items-start",children:[(0,n.jsxs)("div",{className:"flex-1",children:[(0,n.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,n.jsx)("span",{className:"px-2 py-1 text-xs rounded ".concat("urgent_review"===e.notification_type?"bg-red-900 text-red-400":"bg-blue-900 text-blue-400"),children:e.notification_type.toUpperCase().replace("_"," ")}),(0,n.jsx)("span",{className:"text-xs text-gray-400",children:formatTimestamp(e.created_at)})]}),(0,n.jsx)("div",{className:"text-gray-300 text-sm",children:e.message})]}),(0,n.jsx)("button",{onClick:()=>markNotificationRead(e.id),className:"text-green-400 hover:text-green-300 text-sm font-mono",children:"MARK READ"})]})},e.id))})]}),"analytics"===T&&(0,n.jsxs)("div",{children:[(0,n.jsx)("h3",{className:"text-lg font-mono mb-4 text-yellow-400",children:"ANALYTICS"}),g?(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)("div",{className:"p-4 border border-gray-600 rounded",children:[(0,n.jsx)("h4",{className:"text-green-400 font-mono mb-2",children:"QUEUE STATUS"}),(0,n.jsxs)("div",{className:"text-gray-300 text-sm",children:[(0,n.jsx)("strong",{children:"Pending:"})," ",g.queue_status.pending_count]}),(0,n.jsxs)("div",{className:"text-gray-300 text-sm",children:[(0,n.jsx)("strong",{children:"High Priority:"})," ",g.queue_status.high_priority_count]})]}),(0,n.jsxs)("div",{className:"p-4 border border-gray-600 rounded",children:[(0,n.jsx)("h4",{className:"text-green-400 font-mono mb-2",children:"REVIEW STATISTICS"}),(0,n.jsxs)("div",{className:"text-gray-300 text-sm",children:[(0,n.jsx)("strong",{children:"Total Reviewed:"})," ",g.review_stats.total_reviewed]}),(0,n.jsxs)("div",{className:"text-gray-300 text-sm",children:[(0,n.jsx)("strong",{children:"Approved:"})," ",g.review_stats.approved_count]}),(0,n.jsxs)("div",{className:"text-gray-300 text-sm",children:[(0,n.jsx)("strong",{children:"Rejected:"})," ",g.review_stats.rejected_count]}),(0,n.jsxs)("div",{className:"text-gray-300 text-sm",children:[(0,n.jsx)("strong",{children:"Edited:"})," ",g.review_stats.edited_count]}),(0,n.jsxs)("div",{className:"text-gray-300 text-sm",children:[(0,n.jsx)("strong",{children:"Approval Rate:"})," ",g.review_stats.approval_rate.toFixed(2),"%"]}),(0,n.jsxs)("div",{className:"text-gray-300 text-sm",children:[(0,n.jsx)("strong",{children:"Average Review Time:"})," ",g.review_stats.avg_review_time_minutes.toFixed(2)," minutes"]})]}),(0,n.jsxs)("div",{className:"p-4 border border-gray-600 rounded",children:[(0,n.jsx)("h4",{className:"text-green-400 font-mono mb-2",children:"NOTIFICATIONS"}),(0,n.jsxs)("div",{className:"text-gray-300 text-sm",children:[(0,n.jsx)("strong",{children:"Unread:"})," ",g.notifications.unread_count]})]})]}):(0,n.jsx)("div",{className:"text-center py-8 text-gray-400",children:"Loading analytics..."})]})]})}):null}let x={shadowrunBarren:{name:"Shadowrun Barren",background:"bg-gray-950",text:"text-red-300",secondaryText:"text-gray-400",accent:"bg-red-900 text-red-100",prompt:"text-green-500",input:"bg-gray-900 border-red-900 border",inputText:"text-red-200",secondaryBackground:"bg-gray-900"},matrix:{name:"Matrix",background:"bg-black",text:"text-green-400",secondaryText:"text-green-600",accent:"bg-green-700 text-green-200",prompt:"text-green-500",input:"bg-black border-green-700 border",inputText:"text-green-400",secondaryBackground:"bg-green-900 bg-opacity-20"},cyberpunk:{name:"Cyberpunk",background:"bg-purple-900",text:"text-pink-300",secondaryText:"text-blue-300",accent:"bg-pink-600 text-blue-200",prompt:"text-yellow-300",input:"bg-purple-800 border-pink-500 border",inputText:"text-pink-300",secondaryBackground:"bg-purple-800"},terminal:{name:"Terminal",background:"bg-black",text:"text-amber-400",secondaryText:"text-amber-600",accent:"bg-amber-800 text-amber-200",prompt:"text-amber-500",input:"bg-black border-amber-700 border",inputText:"text-amber-400",secondaryBackground:"bg-amber-900 bg-opacity-20"}},m=[{id:"xs",name:"Extra Small",class:"text-xs"},{id:"sm",name:"Small",class:"text-sm"},{id:"base",name:"Medium",class:"text-base"},{id:"lg",name:"Large",class:"text-lg"},{id:"xl",name:"Extra Large",class:"text-xl"}];function ShadowrunConsole(){var e;let{user:t,isSignedIn:s}=(0,i.aF)(),[a,r]=(0,l.useState)(""),[o,d]=(0,l.useState)([]),[h,g]=(0,l.useState)("> "),[u,p]=(0,l.useState)(!1),[b,y]=(0,l.useState)(!1),[v,f]=(0,l.useState)(!1),[j,N]=(0,l.useState)(null),[w,S]=(0,l.useState)(!1),E=(0,l.useRef)(null),T=(0,l.useRef)(null),[k,_]=(0,l.useState)({theme:"shadowrunBarren",fontSize:"base"});(0,l.useEffect)(()=>{let e=localStorage.getItem("shadowrun-settings");if(e)try{let t=JSON.parse(e);_(t)}catch(e){console.error("Failed to parse settings:",e)}g(s?"".concat((null==t?void 0:t.firstName)||"User","@SR > "):"> "),d([{command:"",output:'Shadowrun Interface Terminal v1.0\nType "help" for available commands.\nConnecting to the Matrix...'}])},[s,t]),(0,l.useEffect)(()=>{localStorage.setItem("shadowrun-settings",JSON.stringify(k))},[k]),(0,l.useEffect)(()=>{T.current&&(T.current.scrollTop=T.current.scrollHeight)},[o]),(0,l.useEffect)(()=>{E.current&&E.current.focus()},[]);let addToHistory=function(e,t){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];d(a=>[...a,{command:e,output:t,isProcessing:s,isStreaming:n}])},handleSessionCommand=async e=>{let s=e.split(" "),n=s[1],a=s.slice(2).join(" ");if("create"===n){if(!a){addToHistory(e,"Error: Session name is required. Usage: /session create [name]",!1);return}try{let s=await c.Z.post("http://localhost:5000/api/session",{name:a,gm_user_id:null==t?void 0:t.id});N(s.data.session_id),S(!0),addToHistory(e,'Session "'.concat(a,'" created successfully!\nSession ID: ').concat(s.data.session_id,"\nYou are the Game Master."),!1)}catch(t){addToHistory(e,"Error creating session: ".concat(t instanceof Error?t.message:"Unknown error"),!1)}}else if("join"===n){if(!a){addToHistory(e,"Error: Session ID is required. Usage: /session join [id]",!1);return}try{await c.Z.post("http://localhost:5000/api/session/".concat(a,"/join"),{user_id:null==t?void 0:t.id,role:"player"}),N(a),S(!1),addToHistory(e,"Joined session ".concat(a," as a player."),!1)}catch(t){addToHistory(e,"Error joining session: ".concat(t instanceof Error?t.message:"Unknown error"),!1)}}else addToHistory(e,"Error: Invalid session command. Use /session create [name] or /session join [id]",!1)},handleAiCommand=async e=>{let s=e.substring(4).trim();if(!s){addToHistory(e,"Error: Please provide a message for the AI. Usage: /ai [your message]",!1);return}if(!j){addToHistory(e,"Error: You must be in a session to use AI features.",!1);return}try{let o=await c.Z.post("http://localhost:5000/api/session/".concat(j,"/llm-with-review"),{user_id:null==t?void 0:t.id,context:s,response_type:"narrative",priority:1,require_review:!w});if("pending_review"===o.data.status)addToHistory(e,"AI response generated and sent for DM review.\n"+"Request ID: ".concat(o.data.pending_response_id,"\n")+"You will be notified when the DM approves your response.",!1);else{var n,a,r;addToHistory(e,(null===(r=o.data.choices)||void 0===r?void 0:null===(a=r[0])||void 0===a?void 0:null===(n=a.message)||void 0===n?void 0:n.content)||"AI response received.",!1)}}catch(t){addToHistory(e,"Error getting AI response: ".concat(t instanceof Error?t.message:"Unknown error"),!1)}},handleSubmit=async e=>{if(e.preventDefault(),!a.trim()||u)return;let t=a.trim();r(""),addToHistory(t,"",!0),await handleCommand(t)},handleCommand=async e=>{let t=e.toLowerCase();p(!0);try{if("clear"===t){d([]),p(!1);return}if("help"===t)addToHistory(e,"Available commands:\n- clear: Clear the console\n- help: Show this help message\n- theme [name]: Change console theme (shadowrunBarren, matrix, cyberpunk, terminal)\n- settings: Open settings panel\n- /session create [name]: Create a new game session (GM only)\n- /session join [id]: Join an existing session\n- /dm dashboard: Open DM review dashboard (GM only)\n- /ai [message]: Request AI response with DM review\n- /scene [description]: Set a new scene\n- /roll [dice]: Roll dice (e.g., /roll 3d6)\n- /summon [character]: Summon an NPC\n- /echo [message]: Display a message to all players",!1);else if(t.startsWith("theme ")){let s=t.replace("theme ","");if(x[s]){let t={...k,theme:s};_(t),addToHistory(e,"Theme changed to ".concat(x[s].name),!1)}else addToHistory(e,"Theme not found. Available themes: ".concat(Object.keys(x).join(", ")),!1)}else if("settings"===t)y(!0),addToHistory(e,"Opening settings panel...",!1);else if(t.startsWith("/session "))await handleSessionCommand(e);else if("/dm dashboard"===t)w?j?(f(!0),addToHistory(e,"Opening DM Review Dashboard...",!1)):addToHistory(e,"Error: You must be in a session to access the DM dashboard.",!1):addToHistory(e,"Error: Only Game Masters can access the DM dashboard.",!1);else if(t.startsWith("/ai "))await handleAiCommand(e);else if(t.startsWith("/scene ")){let t=e.substring(7);addToHistory(e,"Setting scene: ".concat(t,"\nThe GM is describing the scene..."),!1)}else if(t.startsWith("/roll ")){let t=e.substring(6);addToHistory(e,"Rolling ".concat(t,"...\nResult: 14 (simulated roll)"),!1)}else addToHistory(e,"Unknown command: ".concat(e,'\nType "help" for available commands.'),!1)}catch(t){console.error("Error processing command:",t),addToHistory(e,"Error: ".concat(t instanceof Error?t.message:"Unknown error processing command"),!1)}finally{p(!1)}},C=x[k.theme],R=(null===(e=m.find(e=>e.id===k.fontSize))||void 0===e?void 0:e.class)||"text-base";return(0,n.jsxs)("div",{className:"min-h-screen flex flex-col ".concat(C.background),children:[(0,n.jsx)("header",{className:"p-2 border-b border-red-900",children:(0,n.jsxs)("div",{className:"flex justify-between items-center",children:[(0,n.jsx)("h1",{className:"".concat(C.prompt," font-mono font-bold"),children:"SHADOWRUN MATRIX INTERFACE"}),(0,n.jsx)("div",{className:"flex items-center gap-2",children:(0,n.jsx)("button",{onClick:()=>y(!0),className:"px-3 py-1 rounded ".concat(C.accent," hover:opacity-80"),children:"Settings"})})]})}),(0,n.jsx)("div",{ref:T,className:"flex-1 p-4 overflow-y-auto font-mono ".concat(R),onClick:()=>{var e;return null===(e=E.current)||void 0===e?void 0:e.focus()},children:o.map((e,t)=>(0,n.jsxs)("div",{className:"mb-4",children:[e.command&&(0,n.jsxs)("div",{className:"flex",children:[(0,n.jsx)("span",{className:"".concat(C.prompt," mr-2"),children:h}),(0,n.jsx)("span",{className:C.text,children:e.command})]}),(0,n.jsxs)("div",{className:"pl-4 whitespace-pre-wrap ".concat(C.secondaryText),children:[e.output,e.isProcessing&&(0,n.jsx)("span",{className:"streaming-cursor ml-1"})]})]},t))}),(0,n.jsx)("form",{onSubmit:handleSubmit,className:"p-2 border-t border-red-900",children:(0,n.jsxs)("div",{className:"flex items-center ".concat(C.input," p-2 rounded"),children:[(0,n.jsx)("span",{className:"".concat(C.prompt," mr-2"),children:h}),(0,n.jsx)("input",{ref:E,type:"text",value:a,onChange:e=>r(e.target.value),className:"flex-1 bg-transparent outline-none ".concat(C.inputText),disabled:u,placeholder:u?"Processing...":"Type a command..."})]})}),b&&(0,n.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50",children:(0,n.jsxs)("div",{className:"".concat(C.secondaryBackground," p-6 rounded-lg max-w-md w-full"),children:[(0,n.jsx)("h2",{className:"".concat(C.prompt," text-xl font-bold mb-4"),children:"Console Settings"}),(0,n.jsxs)("div",{className:"mb-4",children:[(0,n.jsx)("label",{className:"".concat(C.text," block mb-2"),children:"Theme"}),(0,n.jsx)("select",{value:k.theme,onChange:e=>_({...k,theme:e.target.value}),className:"w-full p-2 bg-gray-800 text-white rounded",children:Object.entries(x).map(e=>{let[t,s]=e;return(0,n.jsx)("option",{value:t,children:s.name},t)})})]}),(0,n.jsxs)("div",{className:"mb-4",children:[(0,n.jsx)("label",{className:"".concat(C.text," block mb-2"),children:"Font Size"}),(0,n.jsx)("select",{value:k.fontSize,onChange:e=>_({...k,fontSize:e.target.value}),className:"w-full p-2 bg-gray-800 text-white rounded",children:m.map(e=>(0,n.jsx)("option",{value:e.id,children:e.name},e.id))})]}),(0,n.jsx)("div",{className:"flex justify-end mt-6",children:(0,n.jsx)("button",{onClick:()=>y(!1),className:"px-4 py-2 rounded ".concat(C.accent),children:"Close"})})]})}),v&&j&&(0,n.jsx)(DmDashboard,{sessionId:j,isVisible:v,onClose:()=>f(!1)})]})}function ConsolePage(){return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(r(),{children:[(0,n.jsx)("title",{children:"Shadowrun Interface | Console"}),(0,n.jsx)("meta",{name:"description",content:"Shadowrun RPG terminal interface"})]}),(0,n.jsx)(o.CH,{children:(0,n.jsx)("div",{className:"min-h-screen bg-sr-dark flex flex-col",children:(0,n.jsx)(ShadowrunConsole,{})})}),(0,n.jsx)(o.tj,{children:(0,n.jsx)(i.N1,{})})]})}}},function(e){e.O(0,[703,774,888,179],function(){return e(e.s=5180)}),_N_E=e.O()}]);